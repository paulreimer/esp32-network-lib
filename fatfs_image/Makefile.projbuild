FATFS_IMAGE := $(BUILD_DIR_BASE)/fatfs_image.img

$(FATFS_IMAGE): $(SDKCONFIG_MAKEFILE) $(shell find $(PROJECT_PATH)/fs -type f)
	mkfatfs -c $(PROJECT_PATH)/fs -s $(CONFIG_FATFS_PARTITION_SIZE) $(FATFS_IMAGE)

.PHONY: flash_fatfs
flash_fatfs: $(FATFS_IMAGE)
	$(ESPTOOLPY_WRITE_FLASH) $(CONFIG_FATFS_PARTITION_BASE_ADDR) $(FATFS_IMAGE)
